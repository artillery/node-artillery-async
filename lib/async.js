// Generated by CoffeeScript 1.6.2
(function() {
  var __slice = [].slice;

  exports.serial = function(steps, finalCallback) {
    var index, processNextStep;

    index = 0;
    processNextStep = function(lastArgs) {
      var callback, finalArgs, nextArgs;

      if (lastArgs == null) {
        lastArgs = [];
      }
      if (steps[index] == null) {
        finalArgs = [null].concat(lastArgs);
        if (finalCallback != null) {
          finalCallback.apply(null, finalArgs);
        }
        return;
      }
      callback = function() {
        var args, err;

        err = arguments[0], args = 2 <= arguments.length ? __slice.call(arguments, 1) : [];
        if (err != null) {
          return typeof finalCallback === "function" ? finalCallback(err) : void 0;
        } else {
          return processNextStep(args);
        }
      };
      nextArgs = lastArgs.concat(callback);
      steps[index++].apply(null, nextArgs);
    };
    processNextStep();
  };

}).call(this);
